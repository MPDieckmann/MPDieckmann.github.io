---
title: "SpinTheBottle"
themecolor: "#681d1d"
showmeta: false
---
<style type="text/css">.button-group,.list-view>li,.tab-view>header{display:-webkit-flex;display:flex;-webkit-flex-flow:row nowrap;-moz-flex-flow:row nowrap;-ms-flex-flow:row nowrap;-o-flex-flow:row nowrap;flex-flow:row nowrap}.button-group,.tab-view>header{overflow:auto}.tab-view>header button{white-space:nowrap}.tab-view>section{display:none}.tab-view>section.active{display:block}.list-view{padding:0;margin:0;list-style:none}.list-view>li{overflow:hidden}.button-group button{margin:.125em;white-space:nowrap}.dialog-overlay{position:fixed;z-index:9998;top:0;left:0;right:0;bottom:0;display:block;background:rgba(0,0,0,.25);overflow:auto}dialog.dialog-view{display:block;position:static;margin:1em auto;border:1px solid #000;background:#fff;font:inherit;z-index:9999;min-width:200px;width:100%;max-width:400px;padding:0;-webkit-box-shadow:0 0 1em 0 #000;box-shadow:0 0 1em 0 #000}dialog.dialog-view div{padding:.5em .5em 0}dialog.dialog-view header{border-bottom:inherit;padding:.5em;margin:0}dialog.dialog-view footer{border-top:inherit;padding:.375em;margin-top:.5em}dialog.dialog-view footer button{border-top:inherit}dialog.dialog-view textarea{display:block;width:100%;height:100px;resize:vertical;padding:.25em;margin:0;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}.switch-view{display:-webkit-flex;display:flex;-webkit-flex-flow:row nowrap;-moz-flex-flow:row nowrap;-ms-flex-flow:row nowrap;-o-flex-flow:row nowrap;flex-flow:row nowrap;position:relative}.switch-view>.switch-label{display:block;flex:1 1 auto}.switch-view>.switch-track{display:inline-block;flex:0 0 auto;width:2.4em;height:.8em;background:{{page.themecolor}};background-image:-webkit-gradient(linear,left top,left bottom,from(rgba(128,128,128,.75)),to(rgba(128,128,128,.75)));background-image:-webkit-linear-gradient(top,rgba(128,128,128,.75),rgba(128,128,128,.75));background-image:-moz-linear-gradient(top,rgba(128,128,128,.75),rgba(128,128,128,.75));background-image:linear-gradient(to bottom,rgba(128,128,128,.75),rgba(128,128,128,.75));position:relative;border-radius:.4em;margin:.2em;transition:background .3s;vertical-align:middle;cursor:pointer}.switch-view>.switch-track>.switch-piece{display:inline-block;position:absolute;top:-.1em;left:.7em;bottom:-.1em;width:1em;height:1em;background:{{page.themecolor}};background-image:-webkit-gradient(linear,left top,left bottom,from(rgba(128,128,128,.75)),to(rgba(128,128,128,.75)));background-image:-webkit-linear-gradient(top,rgba(128,128,128,.75),rgba(128,128,128,.75));background-image:-moz-linear-gradient(top,rgba(128,128,128,.75),rgba(128,128,128,.75));background-image:linear-gradient(to bottom,rgba(128,128,128,.75),rgba(128,128,128,.75));border-radius:.5em;box-shadow:0 0 .1em 0 #000;transition:left .3s,background .3s}.switch-view.state-off .switch-track{background:#888}.switch-view.state-off .switch-piece{background:#888;left:-.1em}.switch-view.state-on .switch-track{background:{{page.themecolor}}}.switch-view.state-on .switch-piece{left:1.5em;background:{{page.themecolor}}}body .hidden{display:none}.bottle{display:block;width:100%;margin:0 auto;max-width:400px;overflow:hidden}.bottle-img{display:block;max-width:100%;width:auto;height:auto;-webkit-transform:rotate(0);-ms-transform:rotate(0);-o-transform:rotate(0);transform:rotate(0)}</style>
<script type="text/javascript">var UI=function(){"use strict";function t(){}return new t}();UI.List=function(){"use strict";function t(){var t,e=this;arguments.length>0&&(t=document.getElementById(arguments[0])),t||(t=document.createElement("ul")),this.host=t,t.UITarget=this,t.classList.add("list-view"),t.addEventListener("click",function(t){t.target.classList.contains("remove")&&e.items.indexOf(t.target.parentElement)>=0&&(e.host.removeChild(t.target.parentElement),"function"==typeof e.onremove&&e.onremove({id:t.target.parentElement.getAttribute("data-id")}),t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation())}),t.addEventListener("change",function(t){t.target.classList.contains("value")&&e.items.indexOf(t.target.parentElement)>=0&&"function"==typeof e.onchange&&e.onchange({id:t.target.parentElement.getAttribute("data-id"),value:t.target.value})})}return Object.defineProperties(t.prototype,{items:{get:function(){var t,e=this.host&&this.host.children,a=[],n=0,i=e.length;for(n;t=e[n],n<i;n++)"li"==t.tagName.toLowerCase()&&a.push(t);return a},enumerable:!0,configurable:!1},values:{get:function(){var t,e,a=this.items,n=[],i=0,o=a.length;for(i;t=a[i],i<o;i++){var e=t.getElementsByTagName("input")[0].value;e&&(t.getAttribute("data-id")?n.push({id:t.getAttribute("data-id"),value:e}):n.push(e))}return n},set:function(t){var e,a=this.items,n=0,i=a.length;for(n;e=a[n],n<i;n++)this.host.removeChild(e);for(n=0,i=t.length,n;e=t[n],n<i;n++)e&&("string"==typeof e?this.add(e):this.add(e.id,e.value))},enumerable:!0,configurable:!1},add:{value:function(t){var e;arguments.length>1&&(e=t,t=arguments[1]);var a=document.createElement("li"),n=document.createElement("input"),i=document.createElement("button");return e&&a.setAttribute("data-id",e),n.type="text",n.placeholder=I18n("Insert text here"),t&&(n.value=t),n.classList.add("value"),a.appendChild(n),i.innerHTML=I18n("-"),i.classList.add("remove"),a.appendChild(i),"function"==typeof this.onadd&&this.onadd({id:e,value:t}),this.host.appendChild(a),n.focus(),e?{id:e,value:t}:t},writable:!1,enumerable:!0,configurable:!1}}),t}(),UI.Tab=function(){"use strict";function t(){var t,e=this;arguments.length>0&&(t=document.getElementById(arguments[0])),t||(t=document.createElement("div")),this.host=t,t.UITarget=this,t.classList.add("tab-view"),t.addEventListener("click",function(t){e.headers.indexOf(t.target)>=0&&(e.active={id:t.target.getAttribute("data-for")},t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation())}),null==this.header&&(null==t.firstChild?t.appendChild(document.createElement("header")):t.insertBefore(document.createElement("header"),t.firstChild)),this.active=this.active}return Object.defineProperties(t.prototype,{header:{get:function(){var t,e=this.host&&this.host.children,a=0,n=e.length;for(a;t=e[a],a<n;a++)if("header"==t.tagName.toLowerCase())return t;return null},enumerable:!0,configurable:!1},headers:{get:function(){var t,e=this.header&&this.header.children,a=[],n=0,i=e.length;for(n;t=e[n],n<i;n++)"button"==t.tagName.toLowerCase()&&a.push(t);return a},enumerable:!0,configurable:!1},sections:{get:function(){var t,e=this.host&&this.host.children,a=[],n=0,i=e.length;for(n;t=e[n],n<i;n++)"section"==t.tagName.toLowerCase()&&a.push(t);return a},enumerable:!0,configurable:!1},add:{value:function(t,e){var a=this.get(t);if(null!=a.header||null!=a.section)throw"Already exists: "+t;var n=document.createElement("button");n.setAttribute("data-for",t),n.innerHTML=e,this.header.appendChild(n);var i=document.createElement("section");return i.setAttribute("data-id",t),this.host.appendChild(i),this.active=this.active,{id:t,title:e,header:n,section:i}},writable:!1,enumerable:!0,configurable:!1},get:{value:function(t){var e,a,n=this.headers,i=this.sections,o={id:t,title:null,header:null,section:null},r=0,s=n.length;for(r;e=n[r],r<s;r++)if(e.getAttribute("data-for")==t){o.header=e,o.title=e.innerHTML;break}for(r=0,s=i.length,r;a=i[r],r<s;r++)if(a.getAttribute("data-id")==t){o.section=a;break}return o},writable:!1,enumerable:!0,configurable:!1},remove:{value:function(t){var e=this.get(t);if(null==e.header||null==e.section)throw"Does not exist: "+t;return this.header.removeChild(e.header),this.host.removeChild(e.section),this.active=this.active,e},writable:!1,enumerable:!0,configurable:!1},active:{get:function(){var t,e=this.headers,a=0,n=e.length;for(a;t=e[a],a<n;a++)if(t.classList.contains("active"))return this.get(t.getAttribute("data-for"));if(e.length>0){t=e[0];var i=this.get(t.getAttribute("data-for"));return i.header.classList.add("active"),i.section.classList.add("active"),i}return{id:null,title:null,header:null,section:null}},set:function(t){var e=this.get(t&&t.id);if(null==e.id)return e;if(null==e.header||null==e.section)throw"Not found: "+e.id;var a=this.active;return a.id==e.id?e:(a.header.classList.remove("active"),a.section.classList.remove("active"),e.header.classList.add("active"),e.section.classList.add("active"),e)},enumerable:!0,configurable:!1}}),t}(),UI.Dialog=function(){"use strict";function t(t){var a=document.createElement("div");this.host=a,a.UITarget=this,a.classList.add("dialog-overlay"),t=Object(t),this.promise=new Promise(function(n,i){document.body.appendChild(a);var o=e(t,n,i);a.appendChild(o),a.addEventListener("click",function(t){t.stopPropagation(),t.stopImmediatePropagation(),t.preventDefault(),n({button:!1}),document.body.removeChild(a)})})}function e(t,e,n){var i=document.createElement("dialog");i.classList.add("dialog-view");var o=document.createElement("header");if(o.innerHTML=t.title||"",o.classList.add("headline"),i.appendChild(o),t.text){var r=document.createElement("div");r.innerHTML=t.text,i.appendChild(r)}if(t.editable||t.value){var s=document.createElement("div"),l=document.createElement("textarea");l.placeholder=t.placeholder||"",l.value=t.value||"",l.readOnly=t.editable!==!0,s.appendChild(l),i.appendChild(s)}var c=document.createElement("footer");c.classList.add("button-group"),(!t.buttons||t.buttons.length<=0)&&(t.buttons=[I18n("Ok")]);var u=0,d=t.buttons.length;for(d=d||0;u<d;u++)c.appendChild(a(t.buttons[u]));return i.appendChild(c),i.addEventListener("click",function(a){if(a.stopPropagation(),a.stopImmediatePropagation(),"button"==a.target.tagName.toLowerCase()){a.preventDefault();var n=a.target.UIOptions;e(t.editable?{button:n,value:l.value}:{button:n}),document.body.removeChild(i.parentElement)}}),i}function a(t){t=String(t);var e=document.createElement("button");return e.innerHTML=t,e.UIOptions=t,e}return Object.defineProperties(t.prototype,{then:{value:function(t){var e;if(arguments.length>1&&(e=arguments[1]),"function"==typeof t&&"function"==typeof e)return this.promise.then(t,e);if("function"!=typeof t||e)throw new TypeError("arguments must be of type function");return this.promise.then(t)},writable:!1,enumerable:!0,configurable:!1},catch:{value:function(t){if("function"==typeof t)return this.promise.catch(onresolve);throw new TypeError("argument must be of type function")},writable:!1,enumerable:!0,configurable:!1}}),t}(),UI.Switch=function(){"use strict";function t(t){var e,a=this;(arguments.length>1||t instanceof Node)&&(e=document.getElementById(arguments[0]),t=Object(arguments[1])),e||(e=document.createElement("div"));var n=t.label,i=t.value===!0?"on":"off";if(this.host=e,e.UITarget=this,e.classList.add("switch-view"),n){var o=document.createElement("span");o.classList.add("switch-label"),o.textContent=n,e.appendChild(o)}e.classList.add("state-"+i);var r=document.createElement("span");r.classList.add("switch-track");var s=document.createElement("span");s.classList.add("switch-piece"),r.appendChild(s),e.appendChild(r),e.addEventListener("click",function(t){a.toggle(),t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation()})}return Object.defineProperties(t.prototype,{value:{get:function(){return this.host.classList.contains("state-on")},set:function(t){t===!0?(this.host.classList.remove("state-off"),this.host.classList.add("state-on")):(this.host.classList.remove("state-on"),this.host.classList.add("state-off"))},enumerable:!0,configurable:!1},toggle:{value:function(){var t=this.host.classList.contains("state-on");return arguments.length>0&&(t=arguments[0]),t===!0?(this.host.classList.remove("state-on"),this.host.classList.add("state-off")):(this.host.classList.remove("state-off"),this.host.classList.add("state-on")),t},writable:!1,enumerable:!0,configurable:!1}}),t}();var I18n=function(){"use strict";function t(t){return a.call(e,t)?e[t]:t}var e={},a=Object.prototype.hasOwnProperty;try{var n,i,o=navigator.languages||[navigator.language],r=[],s=0,l=o.length;for(i=new XMLHttpRequest,s;n=o[s][0]+o[s][1],s<l;s++)if(!(r.indexOf(n)>=0)){r.push(n);try{if(i.open("GET",location.pathname.replace(/\/$/,"")+"/i18n/"+n+".json",!1),i.send(),200==i.status){e=JSON.parse(i.responseText||i.response);break}}catch(t){console.warn("aborted:",t)}}}catch(t){console.warn("aborted:",t)}return t}(),Game=function(){"use strict";function t(){var t;arguments.length>0&&(t=document.getElementById(arguments[0])),t||(t=document.createElement("div")),this.host=t,t.classList.add("app-view");var a,n=0,i=e.length;for(n;a=e[n],n<i;n++)a.apply(this,arguments)}var e=[];return t.register=function(t){return"function"==typeof t&&(e.push(t),!0)},t}();(function(){"use strict";function t(t,e,a,n){var i=t.add(e,a),o=new UI.List;n&&(o.values=n),i.section.appendChild(o.host);var r=document.createElement("div");r.classList.add("button-group");var s=document.createElement("button");s.innerHTML=I18n("+ add"),s.addEventListener("click",function(t){o.add(),t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation()}),r.appendChild(s);var l=document.createElement("button");l.innerHTML=I18n("&gt; Export"),l.addEventListener("click",function(t){new UI.Dialog({title:I18n("Export data"),text:I18n("Copy data from the text area below"),value:JSON.stringify(o.values),buttons:["Close"]}),t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation()}),r.appendChild(l);var c=document.createElement("button");c.innerHTML=I18n("&lt; Import"),c.addEventListener("click",function(t){new UI.Dialog({title:I18n("Import data"),text:I18n("Paste data into the text area below"),editable:!0,placeholder:"[]",buttons:[I18n("Import data"),I18n("Abort")]}).then(function(t){if(t.value&&t.button==I18n("Import data")){var e=JSON.parse(t.value);return new UI.Dialog({title:I18n("Import data"),text:I18n("Do you wish to clear the list before importing data?"),buttons:[I18n("Yes"),I18n("No")]}).then(function(t){t.button==I18n("Yes")?o.values=e:o.values=o.values.concat(e)})}}),t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation()}),r.appendChild(c),i.section.appendChild(r)}Game.prototype.setup=function(){for(var e=this,a=!0;this.host.firstChild;)this.host.removeChild(this.host.firstChild);var n=document.createElement("h2");n.innerHTML=I18n("Setup"),this.host.appendChild(n);var i=new UI.Tab,o=i.add("settings",I18n("Settings")),r=new UI.Switch({label:I18n("Jede Frage einmal pro Spieler")});o.section.appendChild(r.host);var s=new UI.List;s.onadd=function(e){a||t(i,e.id,e.value)},s.onchange=function(t){i.get(t.id).header.innerHTML=t.value},s.onremove=function(t){i.remove(t.id)},o.section.appendChild(s.host);var l=document.createElement("div");l.classList.add("button-group");var c=document.createElement("button");c.addEventListener("click",function(t){s.add("tab"+Date.now(),I18n("New Category")),t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation()}),c.innerHTML=I18n("+ add"),l.appendChild(c);var u=document.createElement("button");u.addEventListener("click",function(t){var a=[];a.push({key:"tasksPerPlayer",value:r.value});var n=[],o=!1;s.values.forEach(function(t){var e=i.get(t.id),a=e.section.getElementsByTagName("ul")[0].UITarget,r=a.values;r.length>0&&(n.push({id:t.id,name:t.value,values:r}),o=!0)});var l=i.get("players").section.getElementsByTagName("ul")[0].UITarget.values;localStorage.setItem("spinTheBottlePlayers",JSON.stringify(l)),localStorage.setItem("spinTheBottleData",JSON.stringify(n)),localStorage.setItem("spinTheBottleSettings",JSON.stringify(a)),e.start(l,n,a),t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation()}),u.innerHTML=I18n("Save and start"),l.appendChild(u);var d=document.createElement("button");d.addEventListener("click",function(t){new UI.Dialog({title:I18n("Import data"),text:I18n("Paste data into the text area below"),editable:!0,placeholder:'{"players":[],"data":[],"settings":[]}',buttons:[I18n("Import data and reload page"),I18n("Abort")]}).then(function(t){if(t.value&&t.button==I18n("Import data and reload page")){var e=JSON.parse(t.value);localStorage.setItem("spinTheBottlePlayers",JSON.stringify(e.players||[])),localStorage.setItem("spinTheBottleData",JSON.stringify(e.data||[])),localStorage.setItem("spinTheBottleSettings",JSON.stringify(e.settings||[])),location.reload()}}),t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation()}),d.innerHTML=I18n("&lt; Import"),l.appendChild(d);var I=document.createElement("button");I.addEventListener("click",function(t){var e=[];e.push({key:"tasksPerPlayer",value:r.value});var a=[],n=!1;s.values.forEach(function(t){var e=i.get(t.id),o=e.section.getElementsByTagName("ul")[0].UITarget,r=o.values;r.length>0&&(a.push({id:t.id,name:t.value,values:r}),n=!0)});var o=i.get("players").section.getElementsByTagName("ul")[0].UITarget.values;localStorage.setItem("spinTheBottlePlayers",JSON.stringify(o)),localStorage.setItem("spinTheBottleData",JSON.stringify(a)),localStorage.setItem("spinTheBottleSettings",JSON.stringify(e)),new UI.Dialog({title:I18n("Export data"),text:I18n("Copy data from the text area below"),value:JSON.stringify({players:o,data:a,settings:e}),buttons:[I18n("Close")]}),t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation()}),I.innerHTML=I18n("&gt; Export"),l.appendChild(I),o.section.appendChild(l),this.host.appendChild(i.host);var g=JSON.parse(localStorage.getItem("spinTheBottlePlayers")||"[]"),M=JSON.parse(localStorage.getItem("spinTheBottleData")||"[]"),h=JSON.parse(localStorage.getItem("spinTheBottleSettings")||"[]");t(i,"players",I18n("Players"),g),M.forEach(function(e){s.add(e.id,e.name),t(i,e.id,e.name,e.values)}),h.forEach(function(t){switch(t.key){case"tasksPerPlayer":r.value=t.value}}),a=!1}})(),function(){"use strict";function t(t){var e=document.createElement("div");return e.classList.add("button-group"),t.forEach(function(t){var a=document.createElement("button");a.textContent=t.label,a.addEventListener("click",function(e){try{t.action()}catch(t){console.error("error in button-event:",t)}e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()}),e.appendChild(a)}),e}function e(t){var e=document.createDocumentFragment(),a=document.createElement("h2"),n=document.createElement("figure"),o=document.createElement("img");a.textContent=I18n("Player"),e.appendChild(a),n.classList.add("bottle"),o.classList.add("bottle-img"),o.src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+Cjxzdmcgd2lkdGg9IjY0MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgaGVpZ2h0PSI2NDAiPgogPGRlZnM+CiAgPGZpbHRlciBpZD0iZmlsdGVyNDYzNyIgc3R5bGU9ImNvbG9yLWludGVycG9sYXRpb24tZmlsdGVyczpzUkdCIiBoZWlnaHQ9IjEuMTUxNiIgd2lkdGg9IjIuMzA3OSIgeT0iLS4wNzU4IiB4PSItLjY1Mzk1Ij4KICAgPGZlR2F1c3NpYW5CbHVyIGlkPSJmZUdhdXNzaWFuQmx1cjQ2MzkiIHN0ZERldmlhdGlvbj0iMy4yMTk3OSIvPgogIDwvZmlsdGVyPgogIDxmaWx0ZXIgaWQ9ImZpbHRlcjc1ODAiIHN0eWxlPSJjb2xvci1pbnRlcnBvbGF0aW9uLWZpbHRlcnM6c1JHQiIgaGVpZ2h0PSIxLjcyIiB3aWR0aD0iMS43MiIgeT0iLS4zNiIgeD0iLS4zNiI+CiAgIDxmZUdhdXNzaWFuQmx1ciBpZD0iZmVHYXVzc2lhbkJsdXI3NTgyIiBzdGREZXZpYXRpb249IjQuNjk3MjEiLz4KICA8L2ZpbHRlcj4KICA8ZmlsdGVyIGlkPSJmaWx0ZXIzOTQ3IiBzdHlsZT0iY29sb3ItaW50ZXJwb2xhdGlvbi1maWx0ZXJzOnNSR0IiPgogICA8ZmVHYXVzc2lhbkJsdXIgaWQ9ImZlR2F1c3NpYW5CbHVyMzk0OSIgc3RkRGV2aWF0aW9uPSIyLjc1MTE4Ii8+CiAgPC9maWx0ZXI+CiAgPGxpbmVhckdyYWRpZW50IGlkPSJsaW5lYXJHcmFkaWVudDcwMjciIHkyPSIuNTAwMDEiIHkxPSIuNTAwMDEiIHgxPSItLjA5Mzg4Ij4KICAgPHN0b3AgaWQ9InN0b3A3NjA4IiBzdG9wLWNvbG9yPSIjNTAxNjE2IiBvZmZzZXQ9IjAiLz4KICAgPHN0b3AgaWQ9InN0b3A3NjE2IiBzdG9wLWNvbG9yPSIjYTAyYzJjIiBvZmZzZXQ9Ii4zNzEwNCIvPgogICA8c3RvcCBpZD0ic3RvcDc2MTQiIHN0b3AtY29sb3I9IiM4MDAwMDAiIG9mZnNldD0iLjUzNjI0Ii8+CiAgIDxzdG9wIGlkPSJzdG9wNzYxMCIgc3RvcC1jb2xvcj0iIzJiMDAwMCIgb2Zmc2V0PSIxIi8+CiAgPC9saW5lYXJHcmFkaWVudD4KICA8bGluZWFyR3JhZGllbnQgaWQ9ImxpbmVhckdyYWRpZW50NzAyOSIgeTI9Ii41MDAwMSIgeDI9IjEuMTIyNSIgeTE9Ii41MDAwMSIgeDE9Ii0uMTY0NDYiPgogICA8c3RvcCBpZD0ic3RvcDQ1OTYiIHN0b3AtY29sb3I9IiMzNjJlMGYiIHN0b3Atb3BhY2l0eT0iLjg0NCIgb2Zmc2V0PSIwIi8+CiAgIDxzdG9wIGlkPSJzdG9wNDYxNCIgc3RvcC1jb2xvcj0iI2RmZGZiMyIgb2Zmc2V0PSIuMTk5MDYiLz4KICAgPHN0b3AgaWQ9InN0b3A0NjEyIiBzdG9wLWNvbG9yPSIjZWJlNmI2IiBvZmZzZXQ9Ii40MjU0Ii8+CiAgIDxzdG9wIGlkPSJzdG9wNDYwMiIgc3RvcC1jb2xvcj0iI2U3ZGNhZiIgb2Zmc2V0PSIuNjcyNDEiLz4KICAgPHN0b3AgaWQ9InN0b3A0NTk4IiBzdG9wLWNvbG9yPSIjZGVkMmE2IiBzdG9wLW9wYWNpdHk9IjAiIG9mZnNldD0iMSIvPgogIDwvbGluZWFyR3JhZGllbnQ+CiA8L2RlZnM+CiA8ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIDExMS44NzUpIj4KICA8cGF0aCBpZD0icGF0aDUyMzAiIHRyYW5zZm9ybT0icm90YXRlKC05MCA3OS40NDEgMjA3LjkxKSIgZmlsbD0idXJsKCNsaW5lYXJHcmFkaWVudDcwMjcpIiBkPSJtNTEuMTExIDI2My44YzE2LjA4NC0yLjI4MyAzNS42MDEtMy42NzEgNTYuNzk4IDAuMDY3MDE3LTAuNjUwOTktMjQuNTkxLTEuOTE5LTUwLjU2NS0yLjQzNi03Ni4zMzQgMC4xNDktMi42MzQgMS44My0zLjIwMSAyLjIxNC00Ljk1IDAuMTE5LTUuMTU5LTAuMDU2LTkuMDEtMC4xODktMTMuNzAxLTAuMDM1MDA0LTEuMjk1LTIuMTQ4LTIuMDk0LTIuMDg1LTMuMDUyIDAuMTc4LTMuNjEzLTAuMTM3LTcuODg3LTAuMTM3LTcuODg3LTAuMzU1LTAuNzA5OTktMC40ODktMC45MTItMC43NTYtMS41OTctMC4yMjMtMC41NzEtMC4xOTI5OS0xLjcwMS0xLjExNC0yLjExOC0xMS4zNi0zLjM2NS0yOS41OTEtMi4zNTUtNDQuNzg4LTAuOTkxLTMuMzU2NCAwLjg4OC00LjkxMzUgMi44ODMtNS4xNTI5IDUuNjlsMC4wODQxIDYuNjUzLTIuMTQ4MyAyLjMzOC0wLjEzNTMgMTQuODQ1YzAuNzkyMSAxLjQxMSAxLjgwOTIgMi4zNyAxLjkyNzUgNS4xMjhsLTIuMjE4MiA3NS44MiAwLjA4OTcgMC4wODloMC4wODk3OTgtMC4wNDQwOTh6Ii8+CiAgPGcgc3Ryb2tlLXdpZHRoPSIuMTk3Ij4KICAgIDxwYXRoIGlkPSJyZWN0NjAwNCIgdHJhbnNmb3JtPSJyb3RhdGUoLTkwIDM2OS4zOCAyMDguNTEpIiBmaWxsPSIjMmIwMDAwIiBkPSJtMzM0LjQ3IDE1Ljk0M2MzLjEtMy40OTE3IDUuNDA4LTguNzg5OCA2LjA1LTE0LjU4NCAxLjQ0Ni0xMy4wNDIgMS4wODItMjYuOTQ0IDEuMDgyLTI2Ljk0NCAxNC45MTYtMy4yNjYyIDM3Ljc1NC0zLjA2MTMgNTYuODI4IDAuMTgxMS0wLjE2OCA0OS42NDcgOS40NDUgMzguNjk0IDI1LjI0MyA2MC42ODYgMTAuNjgxIDE0LjM1NiAxOC4xMDMgMzIuMTMzIDE4LjM2MyA1MC4yMzkgMC4wMTg5ODIgMTA2LjQtMC40NzEwMSAyMTAuNC0wLjQ1MiAzMTguOTUtMC41NDEwMiA4LjgxMy0wLjI3NDAyIDE4Ljg1Ni0zLjEwMyAyNi4wNS0wLjUzNjAxIDEuMzYzLTAuODQ2MDEgMi43NjYtMS4zNDIgNC4wNTctMy42MTMgOS40Mi0yOS43NzggMTAuMjM5LTQ2Ljg0IDEwLjM4N2wtNDQuOTY0LTAuMTQ3cy0zNC4wMDgtMC4xNjkwMS00MS42MjItNi4wNDJjLTEuOTM4LTEuNDk2LTQuNTE3LTkuNjM2LTUuMzczLTEzLjIzNS0wLjI2Ny0xLjEyNC0wLjk1Mi0wLjg0NjAxLTAuOTUyLTAuODQ2MDFsMC4wMDQtMi42NzFjLTEuNzA3LTExMy42IDAuMzg0LTIyNS4zOSAwLjU3NTAxLTMzOC4wOSAzLjgxMy00My4xMTQgMzAuNDI4LTYwLjY4MSAzNi41MDMtNjcuOTkyeiIvPgogICAgPGcgZmlsbD0iI2ZmZiI+CiAgICA8cGF0aCBpZD0icGF0aDc1ODQiIG9wYWNpdHk9Ii41IiBkPSJtMTc2LjMgMjE5LjUzYzAgNS4xNTY4LTQuMTgwNCA5LjMzNzMtOS4zMzczIDkuMzM3My01LjE1NjggMC05LjMzNzItNC4xODA0LTkuMzM3Mi05LjMzNzNzNC4xODA0LTkuMzM3MyA5LjMzNzItOS4zMzczYzUuMTU2OSAwIDkuMzM3MyA0LjE4MDQgOS4zMzczIDkuMzM3M3oiIHRyYW5zZm9ybT0icm90YXRlKC05MCAxNjYuOTYgMjE5LjUzKSIgZmlsdGVyPSJ1cmwoI2ZpbHRlcjc1ODApIi8+CiAgICA8cGF0aCBpZD0icGF0aDc1NzAiIG9wYWNpdHk9Ii41IiBkPSJtMjQyLjYzIDI0MS44NmMwIDEyLjMxOS05Ljk4NjYgMjIuMzA2LTIyLjMwNiAyMi4zMDZzLTIyLjMwNi05Ljk4NjYtMjIuMzA2LTIyLjMwNiA5Ljk4NjYtMjIuMzA2IDIyLjMwNi0yMi4zMDYgMjIuMzA2IDkuOTg2NiAyMi4zMDYgMjIuMzA2eiIgdHJhbnNmb3JtPSJyb3RhdGUoLTkwIDIyMC4zMiAyNDEuODYpIiBmaWx0ZXI9InVybCgjZmlsdGVyNzU4MCkiLz4KICAgIDwvZz4KICA8L2c+CiAgPHBhdGggaWQ9InJlY3Q2MDEyIiBvcGFjaXR5PSIuNiIgZD0ibTkwLjMzNyAxNDYuMTljNC45ODUxLTAuNzQxOTkgOS45NzAxLTAuNzg0IDE0Ljk1NSAwbDAuNzExIDEzNy41NmMtNC43NTEgNC4xNDYtMTAuMTMzIDUuOTEtMTUuNjY2IDcuMTAzdi0xNDQuNjd6IiBmaWxsLW9wYWNpdHk9Ii45MDMiIHRyYW5zZm9ybT0icm90YXRlKC05MCA5OC4xNjkgMjE4LjI0KSIgZmlsdGVyPSJ1cmwoI2ZpbHRlcjQ2MzcpIiBzdHJva2Utd2lkdGg9Ii4zNDgiIGZpbGw9IiNmZmUxY2MiLz4KICA8ZyBzdHJva2Utd2lkdGg9Ii4xOTciPgogICAgPHBhdGggaWQ9InBhdGg3NTYwIiBkPSJtMzQ1LjkxIDQ5LjY0NWMxNS4xNzMgMi41MDczIDIwLjczOCA3LjgwNzggMjkuMTk4IDE1LjExdjM2Mi4wNWw1MC43NDEgMC43Mi0yOC40OTItMzk5LjExLTEyLjIzMi0xNi4xODljLTUuODI0IDMuNzQ4MS0xMy40NCA1LjcwNTUtMjAuODg4IDUuODk2NC04LjM3NSAwLjIxMzctMzYuMDA2IDMxLjE3OC00NS42NyA2Mi4xIDUuMDE3IDI1LjI1OSAxNS40NDgtMjMuNDE4IDI3LjM0My0zMC41OHYwLjAwMDA5OXoiIHRyYW5zZm9ybT0icm90YXRlKC05MCAzNzIuMjEgMjE5Ljg4KSIgZmlsdGVyPSJ1cmwoI2ZpbHRlcjM5NDcpIiBmaWxsPSIjMmIwMDAwIi8+CiAgICA8cGF0aCBpZD0icGF0aDYwMDciIHRyYW5zZm9ybT0icm90YXRlKC05MCAzNzMuMDYgMjA4LjUyKSIgZmlsbD0idXJsKCNsaW5lYXJHcmFkaWVudDcwMjkpIiBkPSJtNDQ1LjczIDEyMS43M2MwLjAxODc5OSAxMDYuNC0wLjI5MTI2IDY1LjY0MS0wLjI3MjUyIDE3NC4xOS03LjM2NTcgMS4xODMyLTEwNS4zMiA1LjEyMjktMTQ0Ljg5LTIuMzAxOS0wLjMwODA0LTQ0LjMwNC0wLjMwMjQ5LTEwNy4xNSAwLjk1NDcxLTE3My41IDI5LjQ1My0xLjc4NzcgOTEuMTg3LTEuNTUyMyAxNDQuMiAxLjYwOHoiLz4KICA8L2c+CiAgPGcgc3Ryb2tlPSIjMDAwIiBmaWxsPSJub25lIj4KICAgIDxwYXRoIGlkPSJwYXRoNzUwMyIgdHJhbnNmb3JtPSJyb3RhdGUoLTkwIDI5Mi41MiAyMDguNDUpIiBkPSJtMjIxLjA0IDIwOC45M2M0Ni42MzMtMS4zNjU4IDk0Ljc5Ny0yLjY4NDEgMTQyLjk3IDAuNTA4NzkiLz4KICAgIDxwYXRoIGlkPSJwYXRoNzUwNSIgdHJhbnNmb3JtPSJyb3RhdGUoLTkwIDQ1MS41NyAyMDguNzEpIiBkPSJtMzc5LjMyIDIwNi44NWM0Ni43NDQgNC4wNDU4IDk1LjA0IDQuNjAwOCAxNDQuNSAyLjU0NCIvPgogIDwvZz4KICA8ZyBzdHJva2Utd2lkdGg9IjMiIGZpbGw9IiM1MDAiPgogICAgPHBhdGggaWQ9InJlY3QzOTUxIiBvcGFjaXR5PSIuNSIgdHJhbnNmb3JtPSJyb3RhdGUoLTkwIDM1LjIyOCAyMDcuOTEpIiBkPSJtOS40Mzg3IDIwNi45MWMxNi45NjYtMC45MDcwNiAzNC4xMzMtMS4wMTA2IDUxLjU3OSAwdjIuNzM0OGMtMTcuNDIzLTEuMTQ5NS0zNC42MzYtMS4yNDgxLTUxLjU3OSAwdi0yLjczNDh6Ii8+CiAgICA8cGF0aCBpZD0icGF0aDM5NTQiIG9wYWNpdHk9Ii40IiB0cmFuc2Zvcm09InJvdGF0ZSgtOTAgNTUuNTQ2IDIwNy44OCkiIGQ9Im0yNy4zNCAyMDYuNjJjMTguOS0yLjQxMjEgNDEuNzg4LTEuNDQ4OCA1Ni40MTIgMC0wLjEyOTAzIDAuNjI1MjMtMi4wNjMxIDIuNjcyMi0yLjEwMDIgMy45OTQtMTYuNjc4LTIuMTg2NS0zNC45MDktMi40OTE3LTUyLjQzNyAwLTAuMDM5NDYxLTEuODUxNy0xLjE0MDItMi43NjAxLTEuODc0Ny0zLjk5NHoiLz4KICA8L2c+CiA8L2c+Cjwvc3ZnPgo=",n.appendChild(o),e.appendChild(n);var r=0,s=t.length;return{host:e,rotate:function(e){for(e=parseInt(e)||0;e>=s;)e-=s;for(;e<0;)e+=s;return new Promise(function(n,l){var c,u=1+i(2),d=4*u,I=360/s*e+i(360/s);1==i(2)?c=setInterval(function(){r+=d,r>=360&&(r-=360,u--,d/=2),o.style.webkitTransform="rotate("+r+"deg)",o.style.msTransform="rotate("+r+"deg)",o.style.oTransform="rotate("+r+"deg)",o.style.transform="rotate("+r+"deg)",a.textContent=t[Math.floor(r/360*s)].name,r>=I&&u<=0&&(clearInterval(c),n(e))},1):(u++,c=setInterval(function(){r-=d,r<0&&(r+=360,u--,d/=2),o.style.webkitTransform="rotate("+r+"deg)",o.style.mozTransform="rotate("+r+"deg)",o.style.msTransform="rotate("+r+"deg)",o.style.oTransform="rotate("+r+"deg)",o.style.transform="rotate("+r+"deg)",a.textContent=t[Math.floor(r/360*s)].name,r<I&&u<=0&&(clearInterval(c),n(e))}))},1)}}}function a(){var t=document.createDocumentFragment(),e=document.createElement("h2"),a=document.createElement("ul"),n=function(){},i=n;return a.classList.add("list-view"),a.addEventListener("click",function(){"UIItem"in event.target&&(i(event.target.UIItem),i=n),event.preventDefault(),event.stopPropagation(),event.stopImmediatePropagation()}),e.textContent=I18n("Player"),t.appendChild(e),t.appendChild(a),{host:t,setup:function(t,n,o){for(;a.firstChild;)a.removeChild(a.firstChild);if(e.textContent=t.name,i=o,0==n.length){var r=document.createElement("li");r.textContent=I18n("Sometimes you get a joker"),a.appendChild(r),console.log(new Error("Sometimes you get a joker"),arguments)}else n.forEach(function(t){var e=document.createElement("li"),n=document.createElement("button");n.textContent=t.name,n.UIItem=t,e.appendChild(n),a.appendChild(e)})}}}function n(){var t=document.createDocumentFragment(),e=document.createElement("h2"),a=document.createElement("h3"),n=document.createElement("p");return e.textContent=I18n("Player"),t.appendChild(e),a.textContent=I18n("Category"),t.appendChild(a),n.textContent=I18n("Task"),t.appendChild(n),{host:t,setup:function(t,i,o){e.textContent=t.name,a.textContent=i.name,n.textContent=o,console.log(t.name,i.name,o)}}}function i(t){return Math.floor(Math.round(Math.random()*(t-1)))}Game.prototype.start=function(o,r,s){function l(){p.setup()}function c(){var t=M.length,e=!1;y.active=D.tab,D.buttons.classList.add("hidden");var a=i(t),n=M[a];return n==h&&t>1&&(a++,a>=t&&(a-=t)),h=n,M.splice(a,1),0==M.length&&(m.tasksPerPlayer?(M=v.filter(function(t){return(t!=h||1!=t.data.length||1!=t.data[0].values.length)&&t.data.length>0}),0==M.length&&(e=!0)):M=v.filter(function(){return!0})),m.tasksPerPlayer===!1&&0==L.length&&(e=!0),e?new UI.Dialog({title:I18n("Game is over"),text:I18n(m.tasksPerPlayer?"All tasks in each category is played for each player":"All tasks in each category is played."),editable:!1,buttons:[I18n("Quit game")]}).then(function(){l()}):(a=v.indexOf(n),a<0&&console.error("Player not found"),D.rotate(a).then(function(){D.buttons.classList.remove("hidden")}))}function u(){y.active=f.tab,m.tasksPerPlayer?f.setup(h,h.data,d):f.setup(h,L,d)}function d(t){y.active=j.tab;var e=i(t.values.length),a=t.values.splice(e,1)[0];0==t.values.length&&(m.tasksPerPlayer?(e=h.data.indexOf(t),e<0?console.error("Cannot delete category of",h):h.data.splice(e,1)):(e=L.indexOf(t),e<0?console.error("Cannot delete category of",L):L.splice(e,1))),j.setup(h,t,a)}for(;this.host.firstChild;)this.host.removeChild(this.host.firstChild);var I,g,M,h,p=this,m={tasksPerPlayer:!1},N="",L=[],v=[];(s||[]).forEach(function(t){m[t.key]=t.value}),N=JSON.stringify(r),L=JSON.parse(N),I=L.length,(o||[]).forEach(function(t){var e={name:t};m.tasksPerPlayer&&(e.data=JSON.parse(N)),v.push(e)}),0==v.length&&(m.tasksPerPlayer?v.push({name:I18n("Player"),data:JSON.parse(N)}):v.push({name:I18n("Player")})),g=v.length,M=v.filter(function(){return!0});var y=new UI.Tab;y.header.classList.add("hidden"),this.host.appendChild(y.host);var D=e(v);D.tab=y.add("bottle",I18n("Bottle")),D.tab.section.appendChild(D.host),D.buttons=t([{label:I18n("SpinTheBottle"),action:c},{label:I18n("Next"),action:u},{label:I18n("Quit"),action:l}]),D.tab.section.appendChild(D.buttons);var f=a();f.tab=y.add("categories",I18n("Categories")),f.tab.section.appendChild(f.host),f.buttons=t([{label:I18n("SpinTheBottle"),action:c},{label:I18n("Quit"),action:l}]),f.tab.section.appendChild(f.buttons);var j=n();j.tab=y.add("task",I18n("Task")),j.tab.section.appendChild(j.host),j.buttons=t([{label:I18n("SpinTheBottle"),action:c},{label:I18n("Quit"),action:l}]),j.tab.section.appendChild(j.buttons),c()}}();</script>
<app-view class="app-view" id="app-view-0"></app-view>
<script type="text/javascript">new Game("app-view-0").setup();</script>
