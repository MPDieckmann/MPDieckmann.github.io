---
layout: null
---
{{ site.time }}
<script>
{% assign path = "" | split: "" %}
{% assign currentPath = path | last %}
{% capture output %}[{% endcapture %}

{% for item in site.pages %}
console.group("{{ item.url }}");

console.log("before", {{ path | jsonify }}, "{{ currentPath }}");
  {% for i in path %}
    {% if item.url contains currentPath %}
      {% break %}
    {% endif %}
    {% assign tmp_path = "" | split: "" %}
    {% assign tmp_limit = path | size | minus: 2 %}
    {% for j in path offset: 1 limit: tmp_limit %}
      {% assign tmp_path = tmp_path | push: j %}
    {% endfor %}
    {% assign path = tmp_path %}
    {% assign currentPath = path | last %}
    {% capture output %}{{ output }}null]},{% endcapture %}
  {% endfor %}
console.log("after", {{ path | jsonify }}, "{{ currentPath }}");

  {% if item.next and item.next.url contains item.url %}
    {% assign path = path | push: item.url %}
    {% assign currentPath = path | last %}
    {% capture output %}{{ output }}{"title":"{{ item.title }}","url":"{{ item.url }}","children":[{% endcapture %}
  {% else  %}
    {% capture output %}{{ output }}{"title":"{{ item.title }}","url":"{{ item.url }}"},{% endcapture %}
  {% endif %}

console.groupEnd();
{% endfor %}
{% for i in path offset: 1 %}
  {% capture output %}{{ output }}null]},{% endcapture %}
{% endfor %}
{% capture output %}{{ output }}null]{% endcapture %}

console.log({{ output | jsonify }});
</script>
<pre>{{output}}</pre>
